import{H as k,I as F,r as m,z as t,d as R,J as P,K as j,j as B,L,A as n,v as T,B as y,y as h,M as o,x as M,N,O as w,n as x,_ as z}from"./D2dfyNpS.js";import{V as _,v as D}from"./DBRPP3qg.js";import{c as q,f as A,m as E,V as I,a as S,b as $,d as H,e as J,g as K,h as U}from"./D109hZUS.js";import{u as O,m as G}from"./DPIxVtgw.js";import"./C3ScN-vH.js";const Q=F({...G(),...E()},"VForm"),W=k()({name:"VForm",props:Q(),emits:{"update:modelValue":c=>!0,submit:c=>!0},setup(c,V){let{slots:p,emit:s}=V;const r=q(c),l=m();function g(d){d.preventDefault(),r.reset()}function v(d){const i=d,u=r.validate();i.then=u.then.bind(u),i.catch=u.catch.bind(u),i.finally=u.finally.bind(u),s("submit",i),i.defaultPrevented||u.then(f=>{var e;let{valid:a}=f;a&&((e=l.value)==null||e.submit())}),i.preventDefault()}return O(()=>{var d;return t("form",{ref:l,class:["v-form",c.class],style:c.style,novalidate:!0,onReset:g,onSubmit:v},[(d=p.default)==null?void 0:d.call(p,r)])}),A(r,l)}}),X=R({__name:"login",setup(c){const V=P(),p=j(),s=m("signup"),r=m(""),l=m(""),g=m(!1),v=m(!1),d=m(null),i=B(()=>{if(s.value==="login")return{header:"Login",btn:"Criar Conta"};if(s.value==="signup")return{header:"Criar Conta",btn:"Fazer Login"}}),u=async()=>{try{v.value=!0;const f=p.users;if(s.value==="signup"){if(f.find(b=>b.username===r.value)){alert("Usuário já existe. Escolha outro nome de usuário.");return}let e;do e=Math.floor(1e3+Math.random()*9e3).toString();while(f.some(b=>b.id==e));const C={username:r.value,password:l.value,id:e};V.setUser(C),p.addUser(C),await x("/profile")}else if(s.value==="login"){const a=f.find(e=>e.username===r.value);if(!a){alert("Usuário não encontrado.");return}if(a.password!==l.value){alert("Senha incorreta.");return}if(console.log("Login bem-sucedido:",a),V.setUser(a),!D(a)){await x("/profile");return}await x("/home")}}catch(f){console.error("login err:",f)}finally{v.value=!1}};return(f,a)=>(T(),L(I,{fluid:"",class:"fill-height login-container"},{default:n(()=>[t(S,{align:"center",justify:"center"},{default:n(()=>[t($,{cols:"12",sm:"8",md:"6",lg:"4"},{default:n(()=>[t(H,{class:"elevation-5 pa-4"},{default:n(()=>[t(J,{class:"text-h4 font-weight-thin text-center"},{default:n(()=>{var e;return[y(h((e=o(i))==null?void 0:e.header),1)]}),_:1}),t(S,{"no-gutters":"",class:"justify-center mb-4 opacity-60"},{default:n(()=>[a[4]||(a[4]=M("span",{class:"d-flex justify-center align-center mr-1"}," ou ",-1)),t(_,{onClick:a[0]||(a[0]=e=>s.value=o(s)==="login"?"signup":"login"),variant:"text",size:"small"},{default:n(()=>{var e;return[y(h((e=o(i))==null?void 0:e.btn),1)]}),_:1})]),_:1}),t(K,null,{default:n(()=>[t(W,{onSubmit:N(u,["prevent"]),ref_key:"form",ref:d},{default:n(()=>[t(U,{variant:"plain",modelValue:o(r),"onUpdate:modelValue":a[1]||(a[1]=e=>w(r)?r.value=e:null),label:"Username","prepend-icon":"mdi-account",rules:[e=>!!e||"Username é obrigatório"],required:"",class:"mb-4"},null,8,["modelValue","rules"]),t(U,{variant:"plain",modelValue:o(l),"onUpdate:modelValue":a[2]||(a[2]=e=>w(l)?l.value=e:null),label:"Senha","prepend-icon":"mdi-lock","append-icon":o(g)?"mdi-eye":"mdi-eye-off",type:o(g)?"text":"password",rules:[e=>!!e||"Senha é obrigatória"],"onClick:append":a[3]||(a[3]=e=>g.value=!o(g)),required:""},null,8,["modelValue","append-icon","type","rules"]),t(_,{type:"submit",color:"purple",block:"",large:"",class:"mt-6",loading:o(v)},{default:n(()=>[y(h(o(s)==="login"?"Entrar":"Criar Conta"),1)]),_:1},8,["loading"])]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),re=z(X,[["__scopeId","data-v-a5ffdaed"]]);export{re as default};

import{x as F,y as R,r as m,z as P,b as t,A as j,d as B,u as N,j as T,m as z,g as D,w as s,o as L,i as y,t as x,h as n,e as M,V as S,B as q,l as k,n as w,_ as A}from"./CfrMyiOO.js";import{v as I,p as $}from"./BL8cxo_X.js";import{V as E}from"./DY8IFNtH.js";import{e as G,m as H,V as U,a as J,b as K,c as O,d as Q,f as _}from"./CCiBwHnV.js";import{f as W}from"./B931MWyl.js";import"./C32IOEgb.js";import"./CaRMrAcH.js";import"./y0oum4_2.js";const X=R({...j(),...H()},"VForm"),Y=F()({name:"VForm",props:X(),emits:{"update:modelValue":c=>!0,submit:c=>!0},setup(c,V){let{slots:o,emit:l}=V;const r=G(c),i=m();function p(u){u.preventDefault(),r.reset()}function g(u){const d=u,f=r.validate();d.then=f.then.bind(f),d.catch=f.catch.bind(f),d.finally=f.finally.bind(f),l("submit",d),d.defaultPrevented||f.then(v=>{var e;let{valid:a}=v;a&&((e=i.value)==null||e.submit())}),d.preventDefault()}return P(()=>{var u;return t("form",{ref:i,class:["v-form",c.class],style:c.style,novalidate:!0,onReset:p,onSubmit:g},[(u=o.default)==null?void 0:u.call(o,r)])}),W(r,i)}}),Z=B({__name:"login",setup(c){const V=N(),o=T(),l=m("signup"),r=m(""),i=m(""),p=m(!1),g=m(!1),u=m(null),d=z(()=>{if(l.value==="login")return{header:"Login",btn:"Criar Conta"};if(l.value==="signup")return{header:"Criar Conta",btn:"Fazer Login"}}),f=async()=>{var v;try{g.value=!0;const a=o.users;if(!((v=u.value)!=null&&v.isValid))return;if(l.value==="signup"){if(a.find(h=>h.username===r.value)){o.alertSnackbar("Nome de usuário já existe");return}let b;do b=Math.floor(1e3+Math.random()*9e3).toString();while(a.some(h=>h.id==b));const C={username:r.value,password:i.value,id:Number(b),likedUsers:[]};V.setUser(C),o.addUser(C),await w("/profile")}else if(l.value==="login"){const e=a.find(b=>b.username==r.value);if(!e){o.alertSnackbar("Usuário não encontrado");return}if(e.password!==i.value){o.alertSnackbar("Senha incorreta");return}if(V.setUser(e),!I(e)){await w("/profile");return}await w("/home")}}catch(a){console.error("login err:",a)}finally{$(),g.value=!1}};return(v,a)=>(L(),D(E,{fluid:"",class:"fill-height login-container"},{default:s(()=>[t(U,{align:"center",justify:"center"},{default:s(()=>[t(J,{cols:"12",sm:"8",md:"6",lg:"4"},{default:s(()=>[t(K,{class:"elevation-5 pa-4"},{default:s(()=>[t(O,{class:"text-h4 font-weight-thin text-center"},{default:s(()=>{var e;return[y(x((e=n(d))==null?void 0:e.header),1)]}),_:1}),t(U,{"no-gutters":"",class:"justify-center mb-4 opacity-60"},{default:s(()=>[a[4]||(a[4]=M("span",{class:"d-flex justify-center align-center mr-1"}," ou ",-1)),t(S,{onClick:a[0]||(a[0]=e=>l.value=n(l)==="login"?"signup":"login"),variant:"text",rounded:"xl",size:"small","max-height":"30"},{default:s(()=>{var e;return[y(x((e=n(d))==null?void 0:e.btn),1)]}),_:1})]),_:1}),t(Q,null,{default:s(()=>[t(Y,{onSubmit:q(f,["prevent"]),ref_key:"form",ref:u},{default:s(()=>[t(_,{variant:"plain",modelValue:n(r),"onUpdate:modelValue":a[1]||(a[1]=e=>k(r)?r.value=e:null),label:"Username","hide-details":"",rules:[e=>!!e||"Username é obrigatório"],required:"",class:"mb-4"},null,8,["modelValue","rules"]),t(_,{variant:"plain",modelValue:n(i),"onUpdate:modelValue":a[2]||(a[2]=e=>k(i)?i.value=e:null),label:"Senha","hide-details":"","append-icon":n(p)?"mdi-eye":"mdi-eye-off",type:n(p)?"text":"password",rules:[e=>!!e||"Senha é obrigatória"],"onClick:append":a[3]||(a[3]=e=>p.value=!n(p)),required:""},null,8,["modelValue","append-icon","type","rules"]),t(S,{type:"submit",color:"purple-darken-4",block:"",rounded:"xl",large:"",class:"mt-10",loading:n(g)},{default:s(()=>[y(x(n(l)==="login"?"Entrar":"Criar Conta"),1)]),_:1},8,["loading"])]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),ie=A(Z,[["__scopeId","data-v-ff338ffb"]]);export{ie as default};

import{_ as L}from"./CL_GPwpU.js";import{d as $,u as H,k as O,a as q,r as g,E as G,G as J,p as P,H as Q,I as b,c as u,b as s,w as o,m as S,h as n,F as B,o as c,J as W,V as X,l as Y,i as y,t as w,R as Z,s as ee,v as te,q as I,e as v,K as se,n as ae,_ as oe}from"./CcTqgOqe.js";import{V as ne,a as D}from"./CBKenbfh.js";import{V as re,a as ie}from"./DF6TW70z.js";import{V as le}from"./CCSnsCEp.js";import{V as de,a as ue}from"./78-pPTyu.js";import{V as ce}from"./ByO3cCj3.js";import{a as M,f as me}from"./lewhVoD7.js";import{V as pe}from"./SQ-QVTfp.js";import"./wfaVquSh.js";import"./DFj-8-jc.js";import"./DSBdaTuV.js";import"./D1YMJMmR.js";import"./B931MWyl.js";import"./DH6blgSW.js";import"./CRryNfiK.js";import"./-4ot2Snv.js";import"./C3_38xaj.js";const fe=["id"],ge={key:0,class:"message-time"},ve={key:0,class:"typing-indicator received"},_e={class:"input-wrapper"},he=$({__name:"[chatId]",setup(Ve){const m=H(),U=O(),R=q(),f=g(!1),h=g(!1),N=g(),z=G(),j=J(),E=Number(z.params.chatId),V=g(!1),r=R.chats.find(l=>l.id===E);r||j.push("/matches");const d=P(()=>{var i;const l=(i=m.user)==null?void 0:i.id,e=r==null?void 0:r.participants.find(t=>t!==l);return U.users.find(t=>t.id===e)}),p=g("");let _;function F(l){const e=new Date(l),i={day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"};return e.toLocaleString("pt-BR",i)}function k(){var e;if(!p.value.trim()||!r)return;const l={id:Date.now(),chatId:r.id,sender:((e=m==null?void 0:m.user)==null?void 0:e.id)||0,text:p.value.trim(),timestamp:new Date().toISOString()};r.messages.push(l),p.value="",setTimeout(()=>{V.value=!0,setTimeout(()=>{V.value=!1,setTimeout(()=>{var a;const i=["Sim, concordo!","Beleza, bora f1 então!","Claro, bora!","Com certeza meu mano","vambora cpx!","Vamos lá!"],t={id:Date.now()+1,chatId:r.id,sender:((a=d.value)==null?void 0:a.id)||0,text:i[Math.floor(Math.random()*i.length)],timestamp:new Date().toISOString()};r.messages.push(t)},1e3),x()},3e3)},1e3),x()}function x(){b(()=>{_&&_.scrollTo(0,_.scrollHeight)})}function A(){d.value&&(N.value=d.value.id,f.value=!0)}function K(){ae("/messages")}return Q(()=>{b(()=>{_=document.getElementById("message_container"),x()})}),(l,e)=>{const i=L;return c(),u(B,null,[s(re,{dark:"",app:"",flat:"",style:{background:"transparent",backdropFilter:"blur(15px)"}},{default:o(()=>[s(X,{icon:"",size:"large",onClick:K},{default:o(()=>[s(Y,null,{default:o(()=>e[4]||(e[4]=[y("mdi-arrow-left")])),_:1})]),_:1}),W((c(),u("div",{onClick:A,class:"d-flex w-100 h-100 align-center cursor-pointer rounde-pill"},[s(ue,{size:"40",class:"ml-0 mr-3"},{default:o(()=>{var t,a;return[s(ne,{contain:"",src:((t=n(d))==null?void 0:t.profileImage)||"",alt:(a=n(d))==null?void 0:a.name},null,8,["src","alt"])]}),_:1}),s(ie,{class:"font-weight-light"},{default:o(()=>{var t;return[y(w(((t=n(d))==null?void 0:t.name)||"Chat"),1)]}),_:1})])),[[Z,!0]])]),_:1}),s(le,{modelValue:n(f),"onUpdate:modelValue":e[1]||(e[1]=t=>S(f)?f.value=t:null),transition:"dialog-bottom-transition","content-class":"bg-surface d-flex justify-center align-center",class:"d-flex justify-center align-center",fullscreen:""},{default:o(()=>[s(M,{cols:"12",sm:"7",md:"6",lg:"4",xl:"3",class:"d-flex justify-center align-center ma-0 pa-0"},{default:o(()=>[s(i,{matchedUser:n(d),onClose:e[0]||(e[0]=t=>f.value=!1)},null,8,["matchedUser"])]),_:1})]),_:1},8,["modelValue"]),s(de,{fluid:"",class:"overflow-y-auto d-flex align-center flex-column pa-0 message-container"},{default:o(()=>[s(M,{cols:"12",lg:"6",md:"8",sm:"10",class:"d-flex justify-center"},{default:o(()=>[s(pe,{class:"pa-0 bg-transparent w-100","two-line":""},{default:o(()=>{var t;return[(c(!0),u(B,null,ee(((t=n(r))==null?void 0:t.messages)||[],a=>{var C,T;return c(),u("div",{key:a.id,id:`${a.id}`,class:te([{sent:a.sender===((C=n(m).user)==null?void 0:C.id),received:a.sender!==((T=n(m).user)==null?void 0:T.id)},"message-item"])},[a.text?(c(),u("div",{key:0,class:"message-text",onClick:e[2]||(e[2]=xe=>h.value=!n(h))},[y(w(a.text)+" ",1),s(D,null,{default:o(()=>[n(h)?(c(),u("div",ge,w(F(a.timestamp)),1)):I("",!0)]),_:2},1024)])):I("",!0)],10,fe)}),128)),s(D,null,{default:o(()=>[n(V)?(c(),u("div",ve,e[5]||(e[5]=[v("div",{class:"dots"},[v("span"),v("span"),v("span")],-1)]))):I("",!0)]),_:1})]}),_:1})]),_:1})]),_:1}),s(ce,{app:"",class:"glass-effect",height:"auto"},{default:o(()=>[v("div",_e,[s(me,{modelValue:n(p),"onUpdate:modelValue":e[3]||(e[3]=t=>S(p)?p.value=t:null),placeholder:"Digite sua mensagem...",variant:"solo-filled",density:"comfortable",rounded:"xl",class:"container-input",height:"30","hide-details":"",color:"purple-darken-3",onKeyup:se(k,["enter"]),"append-inner-icon":"mdi-send","onClick:appendInner":k},null,8,["modelValue"])])]),_:1})],64)}}}),Ae=oe(he,[["__scopeId","data-v-b83a120e"]]);export{Ae as default};

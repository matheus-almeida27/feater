import{M as F,N as R,r as f,z as a,d as P,H as j,V as B,j as N,K as T,A as s,v as L,B as y,y as x,L as o,x as M,$ as z,W as U,n as C,_ as D}from"./CAoxyKBU.js";import{v as $}from"./Co0LjnBq.js";import{V as q}from"./oPCrg3Cx.js";import{f as A,g as E,h as H,V as _,a as I,c as K,d as W,e as G,i as S}from"./BijDAzGJ.js";import{V as k}from"./Cx_EXZ8N.js";import{u as J,m as O}from"./D9oNkgbi.js";import"./nxUrYd7-.js";import"./D5FPaojG.js";import"./C3isX3fs.js";import"./DdAhp2J1.js";const Q=R({...O(),...H()},"VForm"),X=F()({name:"VForm",props:Q(),emits:{"update:modelValue":m=>!0,submit:m=>!0},setup(m,h){let{slots:c,emit:n}=h;const r=A(m),l=f();function p(i){i.preventDefault(),r.reset()}function v(i){const u=i,d=r.validate();u.then=d.then.bind(d),u.catch=d.catch.bind(d),u.finally=d.finally.bind(d),n("submit",u),u.defaultPrevented||d.then(g=>{var e;let{valid:t}=g;t&&((e=l.value)==null||e.submit())}),u.preventDefault()}return J(()=>{var i;return a("form",{ref:l,class:["v-form",m.class],style:m.style,novalidate:!0,onReset:p,onSubmit:v},[(i=c.default)==null?void 0:i.call(c,r)])}),E(r,l)}}),Y=P({__name:"login",setup(m){const h=j(),c=B(),n=f("signup"),r=f(""),l=f(""),p=f(!1),v=f(!1),i=f(null),u=N(()=>{if(n.value==="login")return{header:"Login",btn:"Criar Conta"};if(n.value==="signup")return{header:"Criar Conta",btn:"Fazer Login"}}),d=async()=>{var g;try{v.value=!0;const t=c.users;if(!((g=i.value)!=null&&g.isValid))return;if(n.value==="signup"){if(t.find(b=>b.username===r.value)){alert("Usuário já existe. Escolha outro nome de usuário.");return}let V;do V=Math.floor(1e3+Math.random()*9e3).toString();while(t.some(b=>b.id==V));const w={username:r.value,password:l.value,id:Number(V),likedUsers:[]};h.setUser(w),c.addUser(w),await C("/profile")}else if(n.value==="login"){const e=t.find(V=>V.username==r.value);if(!e){alert("Usuário não encontrado.");return}if(e.password!==l.value){alert("Senha incorreta.");return}if(h.setUser(e),!$(e)){await C("/profile");return}await C("/home")}}catch(t){console.error("login err:",t)}finally{v.value=!1}};return(g,t)=>(L(),T(q,{fluid:"",class:"fill-height login-container"},{default:s(()=>[a(_,{align:"center",justify:"center"},{default:s(()=>[a(I,{cols:"12",sm:"8",md:"6",lg:"4"},{default:s(()=>[a(K,{class:"elevation-5 pa-4"},{default:s(()=>[a(W,{class:"text-h4 font-weight-thin text-center"},{default:s(()=>{var e;return[y(x((e=o(u))==null?void 0:e.header),1)]}),_:1}),a(_,{"no-gutters":"",class:"justify-center mb-4 opacity-60"},{default:s(()=>[t[4]||(t[4]=M("span",{class:"d-flex justify-center align-center mr-1"}," ou ",-1)),a(k,{onClick:t[0]||(t[0]=e=>n.value=o(n)==="login"?"signup":"login"),variant:"text",rounded:"xl",size:"small","max-height":"30"},{default:s(()=>{var e;return[y(x((e=o(u))==null?void 0:e.btn),1)]}),_:1})]),_:1}),a(G,null,{default:s(()=>[a(X,{onSubmit:z(d,["prevent"]),ref_key:"form",ref:i},{default:s(()=>[a(S,{variant:"plain",modelValue:o(r),"onUpdate:modelValue":t[1]||(t[1]=e=>U(r)?r.value=e:null),label:"Username","hide-details":"",rules:[e=>!!e||"Username é obrigatório"],required:"",class:"mb-4"},null,8,["modelValue","rules"]),a(S,{variant:"plain",modelValue:o(l),"onUpdate:modelValue":t[2]||(t[2]=e=>U(l)?l.value=e:null),label:"Senha","hide-details":"","append-icon":o(p)?"mdi-eye":"mdi-eye-off",type:o(p)?"text":"password",rules:[e=>!!e||"Senha é obrigatória"],"onClick:append":t[3]||(t[3]=e=>p.value=!o(p)),required:""},null,8,["modelValue","append-icon","type","rules"]),a(k,{type:"submit",color:"purple-darken-4",block:"",rounded:"xl",large:"",class:"mt-10",loading:o(v)},{default:s(()=>[y(x(o(n)==="login"?"Entrar":"Criar Conta"),1)]),_:1},8,["loading"])]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),ue=D(Y,[["__scopeId","data-v-9ced3f95"]]);export{ue as default};

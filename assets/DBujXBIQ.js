import{z as R,A as P,r as f,B,b as r,C as N,d as T,u as j,k as D,l as q,q as z,g as A,w as l,o as L,i as x,t as C,h as i,e as M,V as k,D as I,p as U,n as S,_ as $}from"./3IrZD_pa.js";import{v as E,p as G}from"./C_jzxlMg.js";import{V as H}from"./CH7B2uz2.js";import{e as J,m as K,V as _,a as O,b as Q,c as W,d as X,f as F}from"./_zjfe_JH.js";import{f as Y}from"./B931MWyl.js";import"./4ZpjlLR7.js";import"./BSdXjkqF.js";import"./DOsxrUzH.js";const Z=P({...N(),...K()},"VForm"),ee=R()({name:"VForm",props:Z(),emits:{"update:modelValue":m=>!0,submit:m=>!0},setup(m,V){let{slots:c,emit:g}=V;const t=J(m),s=f();function d(n){n.preventDefault(),t.reset()}function p(n){const u=n,o=t.validate();u.then=o.then.bind(o),u.catch=o.catch.bind(o),u.finally=o.finally.bind(o),g("submit",u),u.defaultPrevented||o.then(h=>{var a;let{valid:v}=h;v&&((a=s.value)==null||a.submit())}),u.preventDefault()}return B(()=>{var n;return r("form",{ref:s,class:["v-form",m.class],style:m.style,novalidate:!0,onReset:d,onSubmit:p},[(n=c.default)==null?void 0:n.call(c,t)])}),Y(t,s)}}),ae=T({__name:"login",setup(m){const V=j(),c=D(),g=q(),t=f("signup"),s=f(""),d=f(""),p=f(!1),n=f(!1),u=f(null),o=z(()=>{if(t.value==="login")return{header:"Login",btn:"Criar Conta"};if(t.value==="signup")return{header:"Criar Conta",btn:"Fazer Login"}}),h=async()=>{var v;try{n.value=!0;const a=c.users;if(!((v=u.value)!=null&&v.isValid))return;if(t.value==="signup"){if(a.find(y=>y.username===s.value)){g.alertSnackbar("Nome de usuário já existe");return}let b;do b=Math.floor(1e3+Math.random()*9e3).toString();while(a.some(y=>y.id==b));const w={username:s.value,password:d.value,id:Number(b),likedUsers:[]};V.setUser(w),c.addUser(w),await S("/profile")}else if(t.value==="login"){const e=a.find(b=>b.username==s.value);if(!e){g.alertSnackbar("Usuário não encontrado");return}if(e.password!==d.value){g.alertSnackbar("Senha incorreta");return}if(V.setUser(e),!E(e)){await S("/profile");return}await S("/home")}}catch(a){console.error("login err:",a)}finally{G(),n.value=!1}};return(v,a)=>(L(),A(H,{fluid:"",class:"fill-height login-container"},{default:l(()=>[r(_,{align:"center",justify:"center"},{default:l(()=>[r(O,{cols:"12",sm:"8",md:"6",lg:"4"},{default:l(()=>[r(Q,{class:"elevation-5 pa-4"},{default:l(()=>[r(W,{class:"text-h4 font-weight-thin text-center"},{default:l(()=>{var e;return[x(C((e=i(o))==null?void 0:e.header),1)]}),_:1}),r(_,{"no-gutters":"",class:"justify-center mb-4 opacity-60"},{default:l(()=>[a[4]||(a[4]=M("span",{class:"d-flex justify-center align-center mr-1"}," ou ",-1)),r(k,{onClick:a[0]||(a[0]=e=>t.value=i(t)==="login"?"signup":"login"),variant:"text",rounded:"xl",size:"small","max-height":"30"},{default:l(()=>{var e;return[x(C((e=i(o))==null?void 0:e.btn),1)]}),_:1})]),_:1}),r(X,null,{default:l(()=>[r(ee,{onSubmit:I(h,["prevent"]),ref_key:"form",ref:u},{default:l(()=>[r(F,{variant:"plain",modelValue:i(s),"onUpdate:modelValue":a[1]||(a[1]=e=>U(s)?s.value=e:null),label:"Username","hide-details":"",rules:[e=>!!e||"Username é obrigatório"],required:"",class:"mb-4"},null,8,["modelValue","rules"]),r(F,{variant:"plain",modelValue:i(d),"onUpdate:modelValue":a[2]||(a[2]=e=>U(d)?d.value=e:null),label:"Senha","hide-details":"","append-icon":i(p)?"mdi-eye":"mdi-eye-off",type:i(p)?"text":"password",rules:[e=>!!e||"Senha é obrigatória"],"onClick:append":a[3]||(a[3]=e=>p.value=!i(p)),required:""},null,8,["modelValue","append-icon","type","rules"]),r(k,{type:"submit",color:"purple-darken-4",block:"",rounded:"xl",large:"",class:"mt-10",loading:i(n)},{default:l(()=>[x(C(i(t)==="login"?"Entrar":"Criar Conta"),1)]),_:1},8,["loading"])]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),de=$(ae,[["__scopeId","data-v-f42eb03f"]]);export{de as default};

import{U as F,V as R,r as m,z as t,d as P,H as j,N as B,j as N,K as T,A as s,v as L,B as y,y as x,L as n,x as z,W as D,O as S,n as C,_ as M}from"./BnXPl0OR.js";import{v as q,p as A}from"./Cf5AFVmD.js";import{V as E}from"./Bg3YD54J.js";import{e as I,m as $,V as U,a as H,b as K,c as O,d as W,f as k}from"./DTLGNzJy.js";import{f as G,V as _}from"./DWl1dh9t.js";import{u as J,m as Q}from"./D3czswpu.js";import"./CKWs_XQo.js";import"./DDEw1AZ_.js";const X=R({...Q(),...$()},"VForm"),Y=F()({name:"VForm",props:X(),emits:{"update:modelValue":c=>!0,submit:c=>!0},setup(c,b){let{slots:o,emit:l}=b;const r=I(c),i=m();function p(u){u.preventDefault(),r.reset()}function v(u){const d=u,f=r.validate();d.then=f.then.bind(f),d.catch=f.catch.bind(f),d.finally=f.finally.bind(f),l("submit",d),d.defaultPrevented||f.then(g=>{var e;let{valid:a}=g;a&&((e=i.value)==null||e.submit())}),d.preventDefault()}return J(()=>{var u;return t("form",{ref:i,class:["v-form",c.class],style:c.style,novalidate:!0,onReset:p,onSubmit:v},[(u=o.default)==null?void 0:u.call(o,r)])}),G(r,i)}}),Z=P({__name:"login",setup(c){const b=j(),o=B(),l=m("signup"),r=m(""),i=m(""),p=m(!1),v=m(!1),u=m(null),d=N(()=>{if(l.value==="login")return{header:"Login",btn:"Criar Conta"};if(l.value==="signup")return{header:"Criar Conta",btn:"Fazer Login"}}),f=async()=>{var g;try{v.value=!0;const a=o.users;if(!((g=u.value)!=null&&g.isValid))return;if(l.value==="signup"){if(a.find(h=>h.username===r.value)){o.alertSnackbar("Usuário já existe. Escolha outro nome de usuário.");return}let V;do V=Math.floor(1e3+Math.random()*9e3).toString();while(a.some(h=>h.id==V));const w={username:r.value,password:i.value,id:Number(V),likedUsers:[]};b.setUser(w),o.addUser(w),await C("/profile")}else if(l.value==="login"){const e=a.find(V=>V.username==r.value);if(!e){o.alertSnackbar("Usuário não encontrado.");return}if(e.password!==i.value){o.alertSnackbar("Senha incorreta.");return}if(b.setUser(e),!q(e)){await C("/profile");return}await C("/home")}}catch(a){console.error("login err:",a)}finally{A(),v.value=!1}};return(g,a)=>(L(),T(E,{fluid:"",class:"fill-height login-container"},{default:s(()=>[t(U,{align:"center",justify:"center"},{default:s(()=>[t(H,{cols:"12",sm:"8",md:"6",lg:"4"},{default:s(()=>[t(K,{class:"elevation-5 pa-4"},{default:s(()=>[t(O,{class:"text-h4 font-weight-thin text-center"},{default:s(()=>{var e;return[y(x((e=n(d))==null?void 0:e.header),1)]}),_:1}),t(U,{"no-gutters":"",class:"justify-center mb-4 opacity-60"},{default:s(()=>[a[4]||(a[4]=z("span",{class:"d-flex justify-center align-center mr-1"}," ou ",-1)),t(_,{onClick:a[0]||(a[0]=e=>l.value=n(l)==="login"?"signup":"login"),variant:"text",rounded:"xl",size:"small","max-height":"30"},{default:s(()=>{var e;return[y(x((e=n(d))==null?void 0:e.btn),1)]}),_:1})]),_:1}),t(W,null,{default:s(()=>[t(Y,{onSubmit:D(f,["prevent"]),ref_key:"form",ref:u},{default:s(()=>[t(k,{variant:"plain",modelValue:n(r),"onUpdate:modelValue":a[1]||(a[1]=e=>S(r)?r.value=e:null),label:"Username","hide-details":"",rules:[e=>!!e||"Username é obrigatório"],required:"",class:"mb-4"},null,8,["modelValue","rules"]),t(k,{variant:"plain",modelValue:n(i),"onUpdate:modelValue":a[2]||(a[2]=e=>S(i)?i.value=e:null),label:"Senha","hide-details":"","append-icon":n(p)?"mdi-eye":"mdi-eye-off",type:n(p)?"text":"password",rules:[e=>!!e||"Senha é obrigatória"],"onClick:append":a[3]||(a[3]=e=>p.value=!n(p)),required:""},null,8,["modelValue","append-icon","type","rules"]),t(_,{type:"submit",color:"purple-darken-4",block:"",rounded:"xl",large:"",class:"mt-10",loading:n(v)},{default:s(()=>[y(x(n(l)==="login"?"Entrar":"Criar Conta"),1)]),_:1},8,["loading"])]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),ie=M(Z,[["__scopeId","data-v-9fb7efa8"]]);export{ie as default};

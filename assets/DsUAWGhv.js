import{S as F,U as R,r as m,z as a,d as P,H as j,M as B,j as T,K as L,A as o,v as M,B as y,y as x,L as s,x as N,V as z,Q as U,n as C,_ as D}from"./CXbttAQh.js";import{v as q}from"./Co0LjnBq.js";import{V as A}from"./DzXHFn0r.js";import{f as E,V as S,a as $}from"./Coajx2eq.js";import{c as H,m as I,V as K,a as Q,b as G,d as _}from"./Ud6A1prX.js";import{V as k}from"./CWIXfn8A.js";import{u as J,m as O}from"./eRPmPRXm.js";import"./Dfa6UwlV.js";import"./C7z5SdtP.js";import"./DbpHdr43.js";import"./Bzi47hvw.js";import"./EMM1h7eV.js";const W=R({...O(),...I()},"VForm"),X=F()({name:"VForm",props:W(),emits:{"update:modelValue":f=>!0,submit:f=>!0},setup(f,h){let{slots:p,emit:n}=h;const r=H(f),l=m();function c(i){i.preventDefault(),r.reset()}function v(i){const u=i,d=r.validate();u.then=d.then.bind(d),u.catch=d.catch.bind(d),u.finally=d.finally.bind(d),n("submit",u),u.defaultPrevented||d.then(g=>{var e;let{valid:t}=g;t&&((e=l.value)==null||e.submit())}),u.preventDefault()}return J(()=>{var i;return a("form",{ref:l,class:["v-form",f.class],style:f.style,novalidate:!0,onReset:c,onSubmit:v},[(i=p.default)==null?void 0:i.call(p,r)])}),E(r,l)}}),Y=P({__name:"login",setup(f){const h=j(),p=B(),n=m("signup"),r=m(""),l=m(""),c=m(!1),v=m(!1),i=m(null),u=T(()=>{if(n.value==="login")return{header:"Login",btn:"Criar Conta"};if(n.value==="signup")return{header:"Criar Conta",btn:"Fazer Login"}}),d=async()=>{var g;try{v.value=!0;const t=p.users;if(!((g=i.value)!=null&&g.isValid))return;if(n.value==="signup"){if(t.find(b=>b.username===r.value)){alert("Usuário já existe. Escolha outro nome de usuário.");return}let V;do V=Math.floor(1e3+Math.random()*9e3).toString();while(t.some(b=>b.id==V));const w={username:r.value,password:l.value,id:Number(V),likedUsers:[]};h.setUser(w),p.addUser(w),await C("/profile")}else if(n.value==="login"){const e=t.find(V=>V.username==r.value);if(!e){alert("Usuário não encontrado.");return}if(e.password!==l.value){alert("Senha incorreta.");return}if(h.setUser(e),!q(e)){await C("/profile");return}await C("/home")}}catch(t){console.error("login err:",t)}finally{v.value=!1}};return(g,t)=>(M(),L(A,{fluid:"",class:"fill-height login-container"},{default:o(()=>[a(S,{align:"center",justify:"center"},{default:o(()=>[a($,{cols:"12",sm:"8",md:"6",lg:"4"},{default:o(()=>[a(K,{class:"elevation-5 pa-4"},{default:o(()=>[a(Q,{class:"text-h4 font-weight-thin text-center"},{default:o(()=>{var e;return[y(x((e=s(u))==null?void 0:e.header),1)]}),_:1}),a(S,{"no-gutters":"",class:"justify-center mb-4 opacity-60"},{default:o(()=>[t[4]||(t[4]=N("span",{class:"d-flex justify-center align-center mr-1"}," ou ",-1)),a(k,{onClick:t[0]||(t[0]=e=>n.value=s(n)==="login"?"signup":"login"),variant:"text",rounded:"xl",size:"small","max-height":"30"},{default:o(()=>{var e;return[y(x((e=s(u))==null?void 0:e.btn),1)]}),_:1})]),_:1}),a(G,null,{default:o(()=>[a(X,{onSubmit:z(d,["prevent"]),ref_key:"form",ref:i},{default:o(()=>[a(_,{variant:"plain",modelValue:s(r),"onUpdate:modelValue":t[1]||(t[1]=e=>U(r)?r.value=e:null),label:"Username","hide-details":"",rules:[e=>!!e||"Username é obrigatório"],required:"",class:"mb-4"},null,8,["modelValue","rules"]),a(_,{variant:"plain",modelValue:s(l),"onUpdate:modelValue":t[2]||(t[2]=e=>U(l)?l.value=e:null),label:"Senha","hide-details":"","append-icon":s(c)?"mdi-eye":"mdi-eye-off",type:s(c)?"text":"password",rules:[e=>!!e||"Senha é obrigatória"],"onClick:append":t[3]||(t[3]=e=>c.value=!s(c)),required:""},null,8,["modelValue","append-icon","type","rules"]),a(k,{type:"submit",color:"purple-darken-4",block:"",rounded:"xl",large:"",class:"mt-10",loading:s(v)},{default:o(()=>[y(x(s(n)==="login"?"Entrar":"Criar Conta"),1)]),_:1},8,["loading"])]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),me=D(Y,[["__scopeId","data-v-9ced3f95"]]);export{me as default};

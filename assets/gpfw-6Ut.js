import{N as F,O as R,r as f,z as a,d as P,H as j,W as B,j as N,K as T,A as s,v as L,B as y,y as x,L as o,x as z,a0 as D,X as U,n as C,_ as M}from"./Bl3r4upV.js";import{v as q,p as A}from"./-dFfTL2n.js";import{V as E}from"./DQfsoG5G.js";import{f as I,g as $,h as H,V as _,a as K,c as O,d as W,e as X,i as S}from"./ChWetMKM.js";import{V as k}from"./oUzMfKMI.js";import{u as G,m as J}from"./BkQ820Tb.js";import"./lZMjZEwB.js";import"./DBpTZaCV.js";import"./u__e0LdV.js";import"./DhafjAVd.js";const Q=R({...J(),...H()},"VForm"),Y=F()({name:"VForm",props:Q(),emits:{"update:modelValue":m=>!0,submit:m=>!0},setup(m,h){let{slots:p,emit:n}=h;const r=I(m),l=f();function c(i){i.preventDefault(),r.reset()}function v(i){const u=i,d=r.validate();u.then=d.then.bind(d),u.catch=d.catch.bind(d),u.finally=d.finally.bind(d),n("submit",u),u.defaultPrevented||d.then(g=>{var e;let{valid:t}=g;t&&((e=l.value)==null||e.submit())}),u.preventDefault()}return G(()=>{var i;return a("form",{ref:l,class:["v-form",m.class],style:m.style,novalidate:!0,onReset:c,onSubmit:v},[(i=p.default)==null?void 0:i.call(p,r)])}),$(r,l)}}),Z=P({__name:"login",setup(m){const h=j(),p=B(),n=f("signup"),r=f(""),l=f(""),c=f(!1),v=f(!1),i=f(null),u=N(()=>{if(n.value==="login")return{header:"Login",btn:"Criar Conta"};if(n.value==="signup")return{header:"Criar Conta",btn:"Fazer Login"}}),d=async()=>{var g;try{v.value=!0;const t=p.users;if(!((g=i.value)!=null&&g.isValid))return;if(n.value==="signup"){if(t.find(b=>b.username===r.value)){alert("Usuário já existe. Escolha outro nome de usuário.");return}let V;do V=Math.floor(1e3+Math.random()*9e3).toString();while(t.some(b=>b.id==V));const w={username:r.value,password:l.value,id:Number(V),likedUsers:[]};h.setUser(w),p.addUser(w),await C("/profile")}else if(n.value==="login"){const e=t.find(V=>V.username==r.value);if(!e){alert("Usuário não encontrado.");return}if(e.password!==l.value){alert("Senha incorreta.");return}if(h.setUser(e),!q(e)){await C("/profile");return}await C("/home")}}catch(t){console.error("login err:",t)}finally{A(),v.value=!1}};return(g,t)=>(L(),T(E,{fluid:"",class:"fill-height login-container"},{default:s(()=>[a(_,{align:"center",justify:"center"},{default:s(()=>[a(K,{cols:"12",sm:"8",md:"6",lg:"4"},{default:s(()=>[a(O,{class:"elevation-5 pa-4"},{default:s(()=>[a(W,{class:"text-h4 font-weight-thin text-center"},{default:s(()=>{var e;return[y(x((e=o(u))==null?void 0:e.header),1)]}),_:1}),a(_,{"no-gutters":"",class:"justify-center mb-4 opacity-60"},{default:s(()=>[t[4]||(t[4]=z("span",{class:"d-flex justify-center align-center mr-1"}," ou ",-1)),a(k,{onClick:t[0]||(t[0]=e=>n.value=o(n)==="login"?"signup":"login"),variant:"text",rounded:"xl",size:"small","max-height":"30"},{default:s(()=>{var e;return[y(x((e=o(u))==null?void 0:e.btn),1)]}),_:1})]),_:1}),a(X,null,{default:s(()=>[a(Y,{onSubmit:D(d,["prevent"]),ref_key:"form",ref:i},{default:s(()=>[a(S,{variant:"plain",modelValue:o(r),"onUpdate:modelValue":t[1]||(t[1]=e=>U(r)?r.value=e:null),label:"Username","hide-details":"",rules:[e=>!!e||"Username é obrigatório"],required:"",class:"mb-4"},null,8,["modelValue","rules"]),a(S,{variant:"plain",modelValue:o(l),"onUpdate:modelValue":t[2]||(t[2]=e=>U(l)?l.value=e:null),label:"Senha","hide-details":"","append-icon":o(c)?"mdi-eye":"mdi-eye-off",type:o(c)?"text":"password",rules:[e=>!!e||"Senha é obrigatória"],"onClick:append":t[3]||(t[3]=e=>c.value=!o(c)),required:""},null,8,["modelValue","append-icon","type","rules"]),a(k,{type:"submit",color:"purple-darken-4",block:"",rounded:"xl",large:"",class:"mt-10",loading:o(v)},{default:s(()=>[y(x(o(n)==="login"?"Entrar":"Criar Conta"),1)]),_:1},8,["loading"])]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),de=M(Z,[["__scopeId","data-v-5fdae6ee"]]);export{de as default};

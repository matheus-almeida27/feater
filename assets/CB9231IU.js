import{d as P,u as se,a as re,c as C,o as c,b as e,w as t,V as B,T as ge,e as p,f as he,g as L,h as v,t as F,i as $,n as _e,_ as K,j as ye,k as ie,r as V,l as Q,m as H,p as O,q as T,F as J,s as Y,v as Z}from"./DItMjVb5.js";import{V as ce,a as ae}from"./BW7UftB5.js";import{V as w,a as D,b as xe,c as be,d as ke}from"./v-NUCI4w.js";import{V as ee,a as te,b as Me}from"./BgyAA8Qv.js";import{V as Ve}from"./DMctM3ly.js";import{V as oe}from"./DxYwZmWC.js";import{V as le}from"./C58w0YQZ.js";import"./C3HPnwFh.js";import"./BBAAwCEX.js";import"./B931MWyl.js";import"./O-wmAhYP.js";import"./Dcv-KI9D.js";import"./CqqHYCyF.js";const Ce={class:"match-dialog"},we=P({__name:"MatchDialogContent",props:{matchInfo:{type:Object,default:()=>null}},emits:["close"],setup(g,{emit:b}){var k,a,d;const u=se(),l=re(),I=g,j=((k=u.user)==null?void 0:k.profileImage)||"",S=b,h=((d=(a=I.matchInfo)==null?void 0:a.name)==null?void 0:d.split(" ")[0])+" também curtiu você!";function R(){const n=l.chats.find(s=>{var i;return s.participants.includes(Number(I.matchInfo.id))&&s.participants.includes(Number((i=u==null?void 0:u.user)==null?void 0:i.id))});S("close"),_e(`/messages/${n==null?void 0:n.id}`)}return(n,s)=>(c(),C("div",Ce,[e(ce,{"fill-height":""},{default:t(()=>[e(B,{variant:"text",rounded:"xl",class:"position-absolute top-0 right-0 mr-3 mt-3",icon:"mdi-close",onClick:s[0]||(s[0]=i=>n.$emit("close"))}),e(w,{align:"center",justify:"center"},{default:t(()=>[e(D,{cols:"12",class:"text-center"},{default:t(()=>[e(ge,{name:"fade"},{default:t(()=>s[1]||(s[1]=[p("div",{class:"match-header"},[p("h2",null,"É um feat!")],-1)])),_:1})]),_:1})]),_:1}),e(w,{align:"center",justify:"center"},{default:t(()=>[e(D,{cols:"12",md:"6",class:"d-flex justify-center"},{default:t(()=>[e(he,{name:"slide-fade",mode:"out-in",tag:"div",class:"avatars"},{default:t(()=>[(c(),L(ae,{size:"150",class:"mx-2",key:"userPhoto"},{default:t(()=>[e(ee,{contain:"",transition:"slide-x-transition",height:"150",width:"150",src:v(j),alt:"Sua foto"},null,8,["src"])]),_:1})),(c(),L(ae,{size:"150",class:"mx-2",key:"matchPhoto"},{default:t(()=>{var i;return[e(ee,{contain:"",transition:"slide-x-reverse-transition",height:"150",width:"150",src:(i=g.matchInfo)==null?void 0:i.profileImage,alt:"Foto do match"},null,8,["src"])]}),_:1}))]),_:1})]),_:1})]),_:1}),e(w,{align:"center",justify:"center"},{default:t(()=>[e(D,{cols:"12",class:"text-center"},{default:t(()=>[p("p",{class:"collaboration-text"},F(h)),s[2]||(s[2]=p("p",{class:"collaboration-text"},"Que tal criar uma música juntos?",-1))]),_:1})]),_:1}),e(w,{align:"center",justify:"center"},{default:t(()=>[e(D,{cols:"12",class:"text-center"},{default:t(()=>[e(B,{class:"ma-4 border",style:{color:"#fff",background:"#170015"},variant:"elevated",rounded:"xl",size:"x-large",onClick:R},{default:t(()=>s[3]||(s[3]=[$(" Enviar Mensagem ")])),_:1})]),_:1})]),_:1})]),_:1})]))}}),Ie=K(we,[["__scopeId","data-v-d73bf81b"]]),ne=ye("filters",{state:()=>({nearbyUsers:!0,genres:[],roles:[]}),actions:{}}),je=P({__name:"FiltersDialogContent",emits:["close"],setup(g,{emit:b}){const u=b,l=ne(),I=ie(),j=V(l.nearbyUsers),S=V(l.genres),h=V(l.roles),R=()=>{l.nearbyUsers=j.value,l.genres=S.value,l.roles=h.value,u("close"),I.alertSnackbar("Filtros aplicados!")};return(k,a)=>(c(),L(D,{cols:"12",md:"8",lg:"6",xl:"4",class:"d-flex ma-0 pa-0 justify-center align-center"},{default:t(()=>[e(xe,{class:"w-100 rounded-xl"},{default:t(()=>[e(be,{class:"pt-3 pl-5 font-weight-light text-h5 mb-2 d-flex align-center"},{default:t(()=>[a[5]||(a[5]=p("span",{class:"text-truncate"}," Filtros ",-1)),e(Ve),e(B,{onClick:a[0]||(a[0]=d=>u("close")),icon:"",rounded:"xl",size:"small",variant:"elevated",color:""},{default:t(()=>[e(Q,{size:"30",class:""},{default:t(()=>a[4]||(a[4]=[$(" mdi-close ")])),_:1})]),_:1})]),_:1}),e(ke,{class:"pb-1 px-0 d-flex flex-column justify-center align-center"},{default:t(()=>[e(w,{"no-gutters":"",class:"justify-center align-center mb-2"},{default:t(()=>a[6]||(a[6]=[p("div",{class:"d-flex w-100 align-center justify-center pa-3 mx-8 nearby_warn"},[p("span",{class:"text-center font-weight-light"}," Por padrão, nós mostramos primeiro os usuários mais próximos em relação à você")],-1)])),_:1}),e(w,{"no-gutters":"",class:"w-100 justify-center align-center mb-6 px-6"},{default:t(()=>{var d;return[e(oe,{modelValue:v(h),"onUpdate:modelValue":a[1]||(a[1]=n=>H(h)?h.value=n:null),items:(d=v(I))==null?void 0:d.roles,label:"Ramos Artísticos",multiple:"",rounded:"xl","hide-details":"","return-object":"",clearable:"","item-title":"name",variant:"solo",chips:"",outlined:"",dense:""},null,8,["modelValue","items"])]}),_:1}),e(w,{"no-gutters":"",class:"w-100 justify-center align-center mb-6 px-6"},{default:t(()=>{var d;return[e(oe,{modelValue:v(S),"onUpdate:modelValue":a[2]||(a[2]=n=>H(S)?S.value=n:null),items:(d=v(I))==null?void 0:d.genres,label:"Gêneros Musicais",multiple:"",rounded:"xl","hide-details":"",clearable:"","return-object":"","item-title":"name",variant:"solo",chips:"",outlined:"",dense:""},null,8,["modelValue","items"])]}),_:1}),e(w,{"no-gutters":"",class:"w-100 justify-center align-center mb-4 px-6"},{default:t(()=>[e(B,{onClick:a[3]||(a[3]=d=>R()),block:"",rounded:"xl",variant:"elevated",color:"purple-darken-1"},{default:t(()=>a[7]||(a[7]=[$(" Aplicar ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Se=K(je,[["__scopeId","data-v-4b7d083d"]]),Re={class:"inner-card"},$e={class:"card-content"},Le={class:"card-name"},Fe={class:"card-address font-weight-regular"},De={class:"card-address font-weight-light mt-1 mb-2"},Te={class:"card-genres"},Be={class:"card-genres"},Ee={class:"d-flex justify-center align-center card-bio"},Ge=P({__name:"InnerCardStack",props:{card:{type:Object,required:!0},showBio:{type:Boolean,default:!1}},setup(g){const b=ne(),u=g,l=se().user,I=O(()=>u.card.favoriteRoles||[]),j=O(()=>u.card.favoriteGenres||[]),S=n=>l==null?void 0:l.favoriteRoles.some(s=>s.id==n.id),h=n=>l==null?void 0:l.favoriteGenres.some(s=>s.id==n.id),R=n=>b==null?void 0:b.roles.some(s=>s.id==n.id),k=n=>b==null?void 0:b.genres.some(s=>s.id==n.id),a=O(()=>{if(u.card.location&&u.card.location.latitude&&u.card.location.longitude){const n=l==null?void 0:l.location;if(n)return`${d(n.latitude,n.longitude,u.card.location.latitude,u.card.location.longitude).toFixed(0)} km de você`}return""}),d=(n,s,i,m)=>{const X=(i-n)*Math.PI/180,z=(m-s)*Math.PI/180,E=Math.sin(X/2)*Math.sin(X/2)+Math.cos(n*Math.PI/180)*Math.cos(i*Math.PI/180)*Math.sin(z/2)*Math.sin(z/2);return 6371*(2*Math.atan2(Math.sqrt(E),Math.sqrt(1-E)))};return(n,s)=>(c(),C("div",Re,[p("div",$e,[g.card.profileImage?(c(),L(ee,{key:0,draggable:"false",src:g.card.profileImage,cover:"",alt:"Imagem",class:"card-img"},null,8,["src"])):T("",!0),p("p",Le,F(g.card.name),1),p("p",Fe,F(g.card.location.address),1),p("p",De,[e(Q,{size:"20",class:"mr-1 mt-n1"},{default:t(()=>s[0]||(s[0]=[$(" mdi-airplane ")])),_:1}),$(F(v(a)),1)]),p("div",Te,[(c(!0),C(J,null,Y(v(I),(i,m)=>(c(),C("span",{key:m,class:Z(["genre-tag border mb-2 ",{"is-favorite":S(i),"in-filter":R(i)}])},F(i.name),3))),128))]),p("div",Be,[(c(!0),C(J,null,Y(v(j),(i,m)=>(c(),C("span",{key:m,class:Z(["genre-tag border mb-2 ",{"is-favorite":h(i),"in-filter":k(i)}])},F(i.name),3))),128))])]),e(te,null,{default:t(()=>[g.showBio?T("",!0):(c(),L(w,{key:0,"no-gutters":"",class:"justify-center"},{default:t(()=>[e(Q,{class:"my-3",size:"25"},{default:t(()=>s[1]||(s[1]=[$("mdi-chevron-down")])),_:1})]),_:1}))]),_:1}),e(te,null,{default:t(()=>[g.showBio?(c(),L(w,{key:0,"no-gutters":"",class:"justify-center"},{default:t(()=>[p("div",Ee,F(g.card.bio),1)]),_:1})):T("",!0)]),_:1})]))}}),Pe=K(Ge,[["__scopeId","data-v-c65851e9"]]),Ue={class:"card-stack w-100"},Xe={key:0,class:"text-center justify-center align-center d-flex"},ze=["onMousedown","onTouchstart"],qe={key:0,class:"d-flex w-100 justify-center align-center"},Ne=P({__name:"SwiperStack",emits:["swipe"],setup(g,{emit:b}){const u=ie(),l=se(),I=re(),j=ne(),S=V(u.users),h=V(!1),R=O(()=>{const r=l.user;if(!r)return[];const{latitude:o,longitude:M}=r.location;return S.value.filter(_=>_.id!==r.id).map(_=>{const f=ue(o,M,_.location.latitude,_.location.longitude),x=j.genres.length?_.favoriteGenres.filter(A=>j.genres.some(W=>W.id===A.id)).length:0,y=j.roles.length?_.favoriteRoles.filter(A=>j.roles.some(W=>W.id===A.id)).length:0;return{..._,distance:f,commonGenresCount:x,commonRolesCount:y}}).sort((_,f)=>{const x=_.commonGenresCount+_.commonRolesCount,y=f.commonGenresCount+f.commonRolesCount;return x>0!=y>0?y>0?1:-1:x!==y?y-x:_.distance-f.distance})}),k=V([...R.value]),a=V(!1),d=V(!1);let n=0,s=0,i=!1,m=V();const U=V(),X=V(),z=()=>{h.value=!h.value};function E(r,o){o===0&&(m.value=document.querySelector("#innerCardRef"),i=!0,n=r.type.includes("touch")?r.touches[0].clientX:r.clientX,s=n,document.addEventListener("mousemove",G),document.addEventListener("touchmove",G),document.addEventListener("mouseup",q),document.addEventListener("touchend",q))}function G(r){if(!i)return;s=r.type.includes("touch")?r.touches[0].clientX:r.clientX;const o=s-n;m.value.style.transform=`translateX(${o}px) rotate(${o/10}deg)`,m.value.style.opacity=1-Math.abs(o)/300}function q(){if(!i)return;i=!1;const r=s-n;if(Math.abs(r)>20&&s!=n)if(Math.abs(r)>100){const o=r>0?"R":"L";h.value=!1;const M=k.value[0];X.value={direction:o,card:M},o=="R"?l.addLikedUser(M.id):l.rmvLikedUser(M.id),m.value.style.transition="transform 0.3s, opacity 0.3s",m.value.style.transform=`translateX(${r>0?500:-500}px)`,m.value.style.opacity=0,setTimeout(()=>{k.value.shift(),h.value=!1,o=="R"&&me(M)},200)}else m.value.style.transition="transform 0.3s, opacity 0.3s",m.value.style.transform="translateX(0)",m.value.style.opacity=1;else m.value.style.transition="transform 0.3s, opacity 0.3s",m.value.style.transform="translateX(0)",m.value.style.opacity=1;document.removeEventListener("mousemove",G),document.removeEventListener("touchmove",G),document.removeEventListener("mouseup",q),document.removeEventListener("touchend",q)}function ue(r,o,M,N){const f=(M-r)*Math.PI/180,x=(N-o)*Math.PI/180,y=Math.sin(f/2)*Math.sin(f/2)+Math.cos(r*Math.PI/180)*Math.cos(M*Math.PI/180)*Math.sin(x/2)*Math.sin(x/2);return 6371*(2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)))}function de(){k.value=R.value}const me=r=>{U.value=r,I.createChat(r),a.value=!0},fe=()=>{d.value=!0},pe=()=>{k.value=R.value,d.value=!1},ve=()=>{a.value=!1,U.value=null};return(r,o)=>{const M=Ie,N=Se,_=Pe;return c(),C(J,null,[e(B,{onClick:fe,variant:"text",class:"filters-btn",icon:""},{default:t(()=>[e(Q,{color:"#fff"},{default:t(()=>o[4]||(o[4]=[$("mdi-tune-variant")])),_:1})]),_:1}),p("div",Ue,[e(le,{modelValue:v(a),"onUpdate:modelValue":o[0]||(o[0]=f=>H(a)?a.value=f:null),fullscreen:"",persistent:""},{default:t(()=>[v(a)?(c(),L(M,{key:0,"match-info":v(U),onClose:ve},null,8,["match-info"])):T("",!0)]),_:1},8,["modelValue"]),e(le,{modelValue:v(d),"onUpdate:modelValue":o[1]||(o[1]=f=>H(d)?d.value=f:null),persistent:"","content-class":"d-flex justify-center align-center"},{default:t(()=>[e(N,{onClose:pe})]),_:1},8,["modelValue"]),e(Me,{"hide-on-leave":""},{default:t(()=>[v(k).length?T("",!0):(c(),C("div",Xe,[e(B,{class:"ma-2",size:"120",variant:"tonal",icon:"",color:"purple-darken-4",onClick:o[2]||(o[2]=f=>de())},{default:t(()=>o[5]||(o[5]=[$("Resetar "),p("br",null,null,-1),$("Stack")])),_:1})]))]),_:1}),(c(!0),C(J,null,Y(v(k),(f,x)=>(c(),C("div",{class:Z(["card",{"card-active":x===0}]),key:f.id,onMousedown:y=>E(y,x),onTouchstart:y=>E(y,x)},[e(te,null,{default:t(()=>[x===0?(c(),C("div",qe,[e(_,{id:"innerCardRef",onClick:o[3]||(o[3]=y=>z()),card:f,"show-bio":v(h)},null,8,["card","show-bio"])])):T("",!0)]),_:2},1024)],42,ze))),128))])],64)}}}),Ae=K(Ne,[["__scopeId","data-v-e6b7d81a"]]),ot=P({__name:"home",setup(g){return(b,u)=>{const l=Ae;return c(),L(ce,{fluid:"",class:"fill-height"},{default:t(()=>[e(w,{align:"center",justify:"center",class:"fill-height"},{default:t(()=>[e(D,{cols:"12",sm:"8",md:"6",lg:"4",xl:"3",class:"fill-height justify-center align-center d-flex"},{default:t(()=>[e(l)]),_:1})]),_:1})]),_:1})}}});export{ot as default};

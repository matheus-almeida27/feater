import{d as G,H as se,I as re,t as C,v as c,z as e,A as t,T as ge,x as p,J as he,K as L,L as v,y as D,B as $,n as _e,_ as K,M as ye,N as ie,r as k,O as Q,j as O,P as T,Q as H,R as Y,S as Z}from"./BnXPl0OR.js";import{V as ce,a as ae}from"./Bg3YD54J.js";import{V as B}from"./DWl1dh9t.js";import{V as w,a as F,b as xe,c as be,d as Me}from"./DTLGNzJy.js";import{V as ee,a as te,b as Ve}from"./CKWs_XQo.js";import{V as ke}from"./DUlq3Ltg.js";import{V as J}from"./D3czswpu.js";import{V as oe}from"./DWqbtqDh.js";import{V as le}from"./RRlyB7SZ.js";import"./DDEw1AZ_.js";import"./rc5dQa0a.js";import"./B_q9z1a9.js";import"./WCBebhKv.js";const Ce={class:"match-dialog"},we=G({__name:"MatchDialogContent",props:{matchInfo:{type:Object,default:()=>null}},emits:["close"],setup(g,{emit:b}){var M,a,d;const u=se(),l=re(),I=g,j=((M=u.user)==null?void 0:M.profileImage)||"",S=b,h=((d=(a=I.matchInfo)==null?void 0:a.name)==null?void 0:d.split(" ")[0])+" também curtiu você!";function R(){const n=l.chats.find(s=>{var i;return s.participants.includes(Number(I.matchInfo.id))&&s.participants.includes(Number((i=u==null?void 0:u.user)==null?void 0:i.id))});S("close"),_e(`/messages/${n==null?void 0:n.id}`)}return(n,s)=>(c(),C("div",Ce,[e(ce,{"fill-height":""},{default:t(()=>[e(B,{variant:"text",rounded:"xl",class:"position-absolute top-0 right-0 mr-3 mt-3",icon:"mdi-close",onClick:s[0]||(s[0]=i=>n.$emit("close"))}),e(w,{align:"center",justify:"center"},{default:t(()=>[e(F,{cols:"12",class:"text-center"},{default:t(()=>[e(ge,{name:"fade"},{default:t(()=>s[1]||(s[1]=[p("div",{class:"match-header"},[p("h2",null,"É um feat!")],-1)])),_:1})]),_:1})]),_:1}),e(w,{align:"center",justify:"center"},{default:t(()=>[e(F,{cols:"12",md:"6",class:"d-flex justify-center"},{default:t(()=>[e(he,{name:"slide-fade",mode:"out-in",tag:"div",class:"avatars"},{default:t(()=>[(c(),L(ae,{size:"150",class:"mx-2",key:"userPhoto"},{default:t(()=>[e(ee,{contain:"",transition:"slide-x-transition",height:"150",width:"150",src:v(j),alt:"Sua foto"},null,8,["src"])]),_:1})),(c(),L(ae,{size:"150",class:"mx-2",key:"matchPhoto"},{default:t(()=>{var i;return[e(ee,{contain:"",transition:"slide-x-reverse-transition",height:"150",width:"150",src:(i=g.matchInfo)==null?void 0:i.profileImage,alt:"Foto do match"},null,8,["src"])]}),_:1}))]),_:1})]),_:1})]),_:1}),e(w,{align:"center",justify:"center"},{default:t(()=>[e(F,{cols:"12",class:"text-center"},{default:t(()=>[p("p",{class:"collaboration-text"},D(h)),s[2]||(s[2]=p("p",{class:"collaboration-text"},"Que tal criar uma música juntos?",-1))]),_:1})]),_:1}),e(w,{align:"center",justify:"center"},{default:t(()=>[e(F,{cols:"12",class:"text-center"},{default:t(()=>[e(B,{class:"ma-4 border",style:{color:"#fff",background:"#170015"},variant:"elevated",rounded:"xl",size:"x-large",onClick:R},{default:t(()=>s[3]||(s[3]=[$(" Enviar Mensagem ")])),_:1})]),_:1})]),_:1})]),_:1})]))}}),Ie=K(we,[["__scopeId","data-v-d73bf81b"]]),ne=ye("filters",{state:()=>({nearbyUsers:!0,genres:[],roles:[]}),actions:{}}),je=G({__name:"FiltersDialogContent",emits:["close"],setup(g,{emit:b}){const u=b,l=ne(),I=ie(),j=k(l.nearbyUsers),S=k(l.genres),h=k(l.roles),R=()=>{l.nearbyUsers=j.value,l.genres=S.value,l.roles=h.value,u("close"),I.alertSnackbar("Filtros aplicados!")};return(M,a)=>(c(),L(F,{cols:"12",md:"8",lg:"6",xl:"4",class:"d-flex ma-0 pa-0 justify-center align-center"},{default:t(()=>[e(xe,{class:"w-100 rounded-xl"},{default:t(()=>[e(be,{class:"pt-3 pl-5 font-weight-light text-h5 mb-2 d-flex align-center"},{default:t(()=>[a[5]||(a[5]=p("span",{class:"text-truncate"}," Filtros ",-1)),e(ke),e(B,{onClick:a[0]||(a[0]=d=>u("close")),icon:"",rounded:"xl",size:"small",variant:"elevated",color:""},{default:t(()=>[e(J,{size:"30",class:""},{default:t(()=>a[4]||(a[4]=[$(" mdi-close ")])),_:1})]),_:1})]),_:1}),e(Me,{class:"pb-1 px-0 d-flex flex-column justify-center align-center"},{default:t(()=>[e(w,{"no-gutters":"",class:"justify-center align-center mb-2"},{default:t(()=>a[6]||(a[6]=[p("div",{class:"d-flex w-100 align-center justify-center pa-3 mx-8 nearby_warn"},[p("span",{class:"text-center font-weight-light"}," Por padrão, nós mostramos primeiro os usuários mais próximos em relação à você")],-1)])),_:1}),e(w,{"no-gutters":"",class:"w-100 justify-center align-center mb-6 px-6"},{default:t(()=>{var d;return[e(oe,{modelValue:v(h),"onUpdate:modelValue":a[1]||(a[1]=n=>Q(h)?h.value=n:null),items:(d=v(I))==null?void 0:d.roles,label:"Ramos Artísticos",multiple:"",rounded:"xl","hide-details":"","return-object":"",clearable:"","item-title":"name",variant:"solo",chips:"",outlined:"",dense:""},null,8,["modelValue","items"])]}),_:1}),e(w,{"no-gutters":"",class:"w-100 justify-center align-center mb-6 px-6"},{default:t(()=>{var d;return[e(oe,{modelValue:v(S),"onUpdate:modelValue":a[2]||(a[2]=n=>Q(S)?S.value=n:null),items:(d=v(I))==null?void 0:d.genres,label:"Gêneros Musicais",multiple:"",rounded:"xl","hide-details":"",clearable:"","return-object":"","item-title":"name",variant:"solo",chips:"",outlined:"",dense:""},null,8,["modelValue","items"])]}),_:1}),e(w,{"no-gutters":"",class:"w-100 justify-center align-center mb-4 px-6"},{default:t(()=>[e(B,{onClick:a[3]||(a[3]=d=>R()),block:"",rounded:"xl",variant:"elevated",color:"purple-darken-1"},{default:t(()=>a[7]||(a[7]=[$(" Aplicar ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Se=K(je,[["__scopeId","data-v-4b7d083d"]]),Re={class:"inner-card"},$e={class:"card-content"},Le={class:"card-name"},De={class:"card-address font-weight-regular"},Fe={class:"card-address font-weight-light mt-1 mb-2"},Te={class:"card-genres"},Be={class:"card-genres"},Pe={class:"d-flex justify-center align-center card-bio"},Ee=G({__name:"InnerCardStack",props:{card:{type:Object,required:!0},showBio:{type:Boolean,default:!1}},setup(g){const b=ne(),u=g,l=se().user,I=O(()=>u.card.favoriteRoles||[]),j=O(()=>u.card.favoriteGenres||[]),S=n=>l==null?void 0:l.favoriteRoles.some(s=>s.id==n.id),h=n=>l==null?void 0:l.favoriteGenres.some(s=>s.id==n.id),R=n=>b==null?void 0:b.roles.some(s=>s.id==n.id),M=n=>b==null?void 0:b.genres.some(s=>s.id==n.id),a=O(()=>{if(u.card.location&&u.card.location.latitude&&u.card.location.longitude){const n=l==null?void 0:l.location;if(n)return`${d(n.latitude,n.longitude,u.card.location.latitude,u.card.location.longitude).toFixed(0)} km de você`}return""}),d=(n,s,i,m)=>{const z=(i-n)*Math.PI/180,X=(m-s)*Math.PI/180,P=Math.sin(z/2)*Math.sin(z/2)+Math.cos(n*Math.PI/180)*Math.cos(i*Math.PI/180)*Math.sin(X/2)*Math.sin(X/2);return 6371*(2*Math.atan2(Math.sqrt(P),Math.sqrt(1-P)))};return(n,s)=>(c(),C("div",Re,[p("div",$e,[g.card.profileImage?(c(),L(ee,{key:0,draggable:"false",src:g.card.profileImage,cover:"",alt:"Imagem",class:"card-img"},null,8,["src"])):T("",!0),p("p",Le,D(g.card.name),1),p("p",De,D(g.card.location.address),1),p("p",Fe,[e(J,{size:"20",class:"mr-1 mt-n1"},{default:t(()=>s[0]||(s[0]=[$(" mdi-airplane ")])),_:1}),$(D(v(a)),1)]),p("div",Te,[(c(!0),C(H,null,Y(v(I),(i,m)=>(c(),C("span",{key:m,class:Z(["genre-tag border mb-2 ",{"is-favorite":S(i),"in-filter":R(i)}])},D(i.name),3))),128))]),p("div",Be,[(c(!0),C(H,null,Y(v(j),(i,m)=>(c(),C("span",{key:m,class:Z(["genre-tag border mb-2 ",{"is-favorite":h(i),"in-filter":M(i)}])},D(i.name),3))),128))])]),e(te,null,{default:t(()=>[g.showBio?T("",!0):(c(),L(w,{key:0,"no-gutters":"",class:"justify-center"},{default:t(()=>[e(J,{class:"my-3",size:"25"},{default:t(()=>s[1]||(s[1]=[$("mdi-chevron-down")])),_:1})]),_:1}))]),_:1}),e(te,null,{default:t(()=>[g.showBio?(c(),L(w,{key:0,"no-gutters":"",class:"justify-center"},{default:t(()=>[p("div",Pe,D(g.card.bio),1)]),_:1})):T("",!0)]),_:1})]))}}),Ge=K(Ee,[["__scopeId","data-v-c65851e9"]]),Ue={class:"card-stack w-100"},ze={key:0,class:"text-center justify-center align-center d-flex"},Xe=["onMousedown","onTouchstart"],Ne={key:0,class:"d-flex w-100 justify-center align-center"},Ae=G({__name:"SwiperStack",emits:["swipe"],setup(g,{emit:b}){const u=ie(),l=se(),I=re(),j=ne(),S=k(u.users),h=k(!1),R=O(()=>{const r=l.user;if(!r)return[];const{latitude:o,longitude:V}=r.location;return S.value.filter(_=>_.id!==r.id).map(_=>{const f=ue(o,V,_.location.latitude,_.location.longitude),x=j.genres.length?_.favoriteGenres.filter(q=>j.genres.some(W=>W.id===q.id)).length:0,y=j.roles.length?_.favoriteRoles.filter(q=>j.roles.some(W=>W.id===q.id)).length:0;return{..._,distance:f,commonGenresCount:x,commonRolesCount:y}}).sort((_,f)=>{const x=_.commonGenresCount+_.commonRolesCount,y=f.commonGenresCount+f.commonRolesCount;return x>0!=y>0?y>0?1:-1:x!==y?y-x:_.distance-f.distance})}),M=k([...R.value]),a=k(!1),d=k(!1);let n=0,s=0,i=!1,m=k();const U=k(),z=k(),X=()=>{h.value=!h.value};function P(r,o){o===0&&(m.value=document.querySelector("#innerCardRef"),i=!0,n=r.type.includes("touch")?r.touches[0].clientX:r.clientX,s=n,document.addEventListener("mousemove",E),document.addEventListener("touchmove",E),document.addEventListener("mouseup",N),document.addEventListener("touchend",N))}function E(r){if(!i)return;s=r.type.includes("touch")?r.touches[0].clientX:r.clientX;const o=s-n;m.value.style.transform=`translateX(${o}px) rotate(${o/10}deg)`,m.value.style.opacity=1-Math.abs(o)/300}function N(){if(!i)return;i=!1;const r=s-n;if(Math.abs(r)>20&&s!=n)if(Math.abs(r)>100){const o=r>0?"R":"L";h.value=!1;const V=M.value[0];z.value={direction:o,card:V},o=="R"?l.addLikedUser(V.id):l.rmvLikedUser(V.id),m.value.style.transition="transform 0.3s, opacity 0.3s",m.value.style.transform=`translateX(${r>0?500:-500}px)`,m.value.style.opacity=0,setTimeout(()=>{M.value.shift(),h.value=!1,o=="R"&&me(V)},200)}else m.value.style.transition="transform 0.3s, opacity 0.3s",m.value.style.transform="translateX(0)",m.value.style.opacity=1;else m.value.style.transition="transform 0.3s, opacity 0.3s",m.value.style.transform="translateX(0)",m.value.style.opacity=1;document.removeEventListener("mousemove",E),document.removeEventListener("touchmove",E),document.removeEventListener("mouseup",N),document.removeEventListener("touchend",N)}function ue(r,o,V,A){const f=(V-r)*Math.PI/180,x=(A-o)*Math.PI/180,y=Math.sin(f/2)*Math.sin(f/2)+Math.cos(r*Math.PI/180)*Math.cos(V*Math.PI/180)*Math.sin(x/2)*Math.sin(x/2);return 6371*(2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)))}function de(){M.value=R.value}const me=r=>{U.value=r,I.createChat(r),a.value=!0},fe=()=>{d.value=!0},pe=()=>{M.value=R.value,d.value=!1},ve=()=>{a.value=!1,U.value=null};return(r,o)=>{const V=Ie,A=Se,_=Ge;return c(),C(H,null,[e(B,{onClick:fe,variant:"text",class:"filters-btn",icon:""},{default:t(()=>[e(J,{color:"#fff"},{default:t(()=>o[4]||(o[4]=[$("mdi-tune-variant")])),_:1})]),_:1}),p("div",Ue,[e(le,{modelValue:v(a),"onUpdate:modelValue":o[0]||(o[0]=f=>Q(a)?a.value=f:null),fullscreen:"",persistent:""},{default:t(()=>[v(a)?(c(),L(V,{key:0,"match-info":v(U),onClose:ve},null,8,["match-info"])):T("",!0)]),_:1},8,["modelValue"]),e(le,{modelValue:v(d),"onUpdate:modelValue":o[1]||(o[1]=f=>Q(d)?d.value=f:null),persistent:"","content-class":"d-flex justify-center align-center"},{default:t(()=>[e(A,{onClose:pe})]),_:1},8,["modelValue"]),e(Ve,{"hide-on-leave":""},{default:t(()=>[v(M).length?T("",!0):(c(),C("div",ze,[e(B,{class:"ma-2",size:"120",variant:"tonal",icon:"",color:"purple-darken-4",onClick:o[2]||(o[2]=f=>de())},{default:t(()=>o[5]||(o[5]=[$("Resetar "),p("br",null,null,-1),$("Stack")])),_:1})]))]),_:1}),(c(!0),C(H,null,Y(v(M),(f,x)=>(c(),C("div",{class:Z(["card",{"card-active":x===0}]),key:f.id,onMousedown:y=>P(y,x),onTouchstart:y=>P(y,x)},[e(te,null,{default:t(()=>[x===0?(c(),C("div",Ne,[e(_,{id:"innerCardRef",onClick:o[3]||(o[3]=y=>X()),card:f,"show-bio":v(h)},null,8,["card","show-bio"])])):T("",!0)]),_:2},1024)],42,Xe))),128))])],64)}}}),qe=K(Ae,[["__scopeId","data-v-e6b7d81a"]]),ot=G({__name:"home",setup(g){return(b,u)=>{const l=qe;return c(),L(ce,{fluid:"",class:"fill-height"},{default:t(()=>[e(w,{align:"center",justify:"center",class:"fill-height"},{default:t(()=>[e(F,{cols:"12",sm:"8",md:"6",lg:"4",xl:"3",class:"fill-height justify-center align-center d-flex"},{default:t(()=>[e(l)]),_:1})]),_:1})]),_:1})}}});export{ot as default};

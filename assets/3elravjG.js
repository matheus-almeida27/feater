import{_ as $}from"./D7vRAG9n.js";import{d as A,H as L,M as E,I as O,r as v,X as F,Y as H,j as K,o as P,Z as y,t as u,z as a,A as s,O as k,v as c,$ as X,B as h,y as _,P as Y,L as x,R as Z,x as b,N as q,a0 as G,n as J,_ as Q}from"./D_QAHc3E.js";import{V as W,a as ee}from"./DD40gWNe.js";import{V as te,a as ae}from"./bcdCKBxt.js";import{V as se}from"./gZINeaGD.js";import{V as oe,a as ne}from"./B7-YwcJB.js";import{V as re}from"./5hqXsJ-P.js";import{V as ie}from"./Bvp8aknx.js";import{V as le,R as de}from"./4hN9MWv1.js";import{a as B}from"./CulAqhRC.js";import{V as me}from"./Bbnitr0W.js";import{d as ue}from"./DGkJGnm-.js";import"./Co0LjnBq.js";import"./BzltYu0d.js";import"./DwH9D4CK.js";import"./7tPTPzUM.js";import"./2aAUO75_.js";import"./7HVeK3Oc.js";import"./pEcBAFqp.js";import"./GfDgDa_v.js";import"./B_er0HLw.js";const ce={class:"message-text"},pe={key:0,class:"message-time"},fe=A({__name:"[chatId]",setup(ge){const d=L(),S=E(),T=O(),V=v(!1),p=v(!1),D=v(),M=F(),U=H(),N=Number(M.params.chatId),n=T.chats.find(i=>i.id===N);n||U.push("/matches");const l=K(()=>{var r;const i=(r=d.user)==null?void 0:r.id,t=n==null?void 0:n.participants.find(e=>e!==i);return S.users.find(e=>e.id===t)}),m=v("");let f;function R(i){const t=new Date(i),r={day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"};return t.toLocaleString("pt-BR",r)}function I(){var r;if(!m.value.trim()||!n)return;const i={id:Date.now(),chatId:n.id,sender:((r=d==null?void 0:d.user)==null?void 0:r.id)||0,text:m.value.trim(),timestamp:new Date().toISOString()};n.messages.push(i),m.value="";let t=["Sim, concordo!","Beleza, bora f1 então!","Claro, bora!","Com certeza meu mano","vambora cpx!","Vamos lá!"];setTimeout(()=>{var o;const e={id:Date.now()+1,chatId:n.id,sender:((o=l.value)==null?void 0:o.id)||0,text:t[Math.floor(Math.random()*t.length)],timestamp:new Date().toISOString()};n.messages.push(e),g()},1200),g()}function g(){y(()=>{f&&f.scrollTo(0,f.scrollHeight)})}function z(){l.value&&(D.value=l.value.id,p.value=!0)}function j(){J("/messages")}return P(()=>{y(()=>{f=document.getElementById("message_container"),g()})}),(i,t)=>{const r=$;return c(),u(k,null,[a(te,{dark:"",app:"",flat:""},{default:s(()=>[a(ie,{icon:"",size:"large",onClick:j},{default:s(()=>[a(le,null,{default:s(()=>t[5]||(t[5]=[h("mdi-arrow-left")])),_:1})]),_:1}),X((c(),u("div",{onClick:z,class:"d-flex w-100 h-100 align-center cursor-pointer rounde-pill"},[a(ne,{size:"40",class:"ml-0 mr-3"},{default:s(()=>{var e,o;return[a(W,{contain:"",src:((e=l.value)==null?void 0:e.profileImage)||"",alt:(o=l.value)==null?void 0:o.name},null,8,["src","alt"])]}),_:1}),a(ae,{class:"font-weight-light"},{default:s(()=>{var e;return[h(_(((e=l.value)==null?void 0:e.name)||"Chat"),1)]}),_:1})])),[[de,!0]])]),_:1}),a(se,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=e=>p.value=e),transition:"dialog-bottom-transition","content-class":"bg-surface d-flex justify-center align-center",class:"d-flex justify-center align-center",fullscreen:""},{default:s(()=>[a(B,{cols:"12",sm:"7",md:"6",lg:"4",xl:"3",class:"d-flex justify-center align-center ma-0 pa-0"},{default:s(()=>[a(r,{matchedUser:l.value,onClose:t[0]||(t[0]=e=>p.value=!1)},null,8,["matchedUser"])]),_:1})]),_:1},8,["modelValue"]),a(oe,{id:"message_container",fluid:"",class:"overflow-y-auto h-100 d-flex flex-column align-center pa-0 message-container"},{default:s(()=>[a(B,{cols:"12",lg:"6",md:"8",class:"d-flex justify-center pb-0"},{default:s(()=>[a(me,{class:"pa-0 bg-transparent w-100","two-line":""},{default:s(()=>{var e;return[(c(!0),u(k,null,Y(((e=x(n))==null?void 0:e.messages)||[],o=>{var w,C;return c(),u("div",{key:o.id,onClick:t[2]||(t[2]=ve=>V.value=!V.value),class:Z([{sent:o.sender===((w=x(d).user)==null?void 0:w.id),received:o.sender!==((C=x(d).user)==null?void 0:C.id)},"message-item"])},[b("div",ce,[h(_(o.text)+" ",1),a(ee,null,{default:s(()=>[V.value?(c(),u("div",pe,_(R(o.timestamp)),1)):q("",!0)]),_:2},1024)])],2)}),128))]}),_:1})]),_:1})]),_:1}),a(re,{app:"",height:"auto",class:"bg-transparent"},{default:s(()=>[b("div",{class:"input-wrapper",onClick:t[4]||(t[4]=e=>g())},[a(ue,{modelValue:m.value,"onUpdate:modelValue":t[3]||(t[3]=e=>m.value=e),placeholder:"Digite sua mensagem...",variant:"solo-filled",density:"comfortable",rounded:"xl",class:"container-input",height:"30","hide-details":"",color:"purple-darken-3",onKeyup:G(I,["enter"]),"append-inner-icon":"mdi-send","onClick:appendInner":I},null,8,["modelValue"])])]),_:1})],64)}}}),Ae=Q(fe,[["__scopeId","data-v-7bf3307f"]]);export{Ae as default};
